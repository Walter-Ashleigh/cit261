<!DOCTYPE html>

<html lang="en-us">
<head>
    <meta charset="utf-8" />
    <title>AJAX</title>
    <meta name="viewport" content="width=device-width,
    initial-scale=1.0">
    <link rel="stylesheet" type="text/css" href="StyleSheet1.css">
    </head>
<body>
    <main>
        <header>AJAX</header>
        <div>
            <h1>AJAX - What is it?</h1>
            <p>AJAX : Asynchronous JavaScript And XML
            <br></br>
            It allows you to update a portion of a webpage by exchanging data behind the scenes 
            with a web browser and without needing to reload the entire page.  AJAX uses the 
            built in XMLHttpRequest object to request the data from a server and JavaScript and
            HTML allow you to display or use that data. 
            </p>
            <p>Some things you can do with AJAX:
            <br></br>
            &bull; Update a page without reloading it
            <br></br>
            &bull; Send data to a server (in the background)
            <br></br>
            &bull; Request data from a server (after the page has loaded)
            <br></br>
            &bull; Send data to a server (after the page has loaded)
            </p>
            <p>The 7 Steps of AJAX:
            <br></br>
            1. Event occurs (ex. button is clicked)
            <br></br>
            2. XMLHttpRequest object is created by JavaScript
            <br></br>
            3. XMLHttpRequest object send the request to a server
            <br></br>
            4. Server processes the request
            <br></br>
            5. Server sends a response back to the page
            <br></br>
            6. JavaScript reads the response
            <br></br>
            7. JavaScript performs the necessary action (ex. page is updated)
            </p>
        </div>
        <div>
            <h1>XMLHttpRequest object</h1>
            <p>Example JavaScript Syntax:
            <!-- HTML generated using hilite.me --><div style="background: #eeeedd; overflow:auto;width:auto;border:solid gray;border-width:.1em .1em .1em .8em;padding:.2em .6em;"><pre style="margin: 0; line-height: 125%"><span style="color: #228B22">// Create the object</span>
<span style="color: #8B008B; font-weight: bold">var</span> xhttp = <span style="color: #8B008B; font-weight: bold">new</span> XMLHttpRequest();
<span style="color: #228B22">// Specifies a function to be executed when the object changes</span>
xhttp.onreadystatechange = <span style="color: #8B008B; font-weight: bold">function</span>() {
    <span style="color: #228B22">// If statement to check that the response is ready</span>
    <span style="color: #8B008B; font-weight: bold">if</span> (<span style="color: #8B008B; font-weight: bold">this</span>.readyState == <span style="color: #B452CD">4</span> &amp;&amp; <span style="color: #8B008B; font-weight: bold">this</span>.status == <span style="color: #B452CD">200</span>) {
       <span style="color: #228B22">// Return the response as a string, which can be used to update the webpage</span>
       <span style="color: #658b00">document</span>.getElementById(<span style="color: #CD5555">&quot;demo&quot;</span>).innerHTML = xhttp.responseText;
    }
};
xhttp.open(<span style="color: #CD5555">&quot;GET&quot;</span>, <span style="color: #CD5555">&quot;filename&quot;</span>, <span style="color: #8B008B; font-weight: bold">true</span>);
xhttp.send();
</pre></div>
            <!-- HTML generated using hilite.me --><div style="background: #eeeedd; overflow:auto;width:auto;border:solid gray;border-width:.1em .1em .1em .8em;padding:.2em .6em;"><pre style="margin: 0; line-height: 125%"><span style="color: #228B22">// Specifies the type of request</span>
<span style="color: #228B22">// open(method, url, async)</span>
xhttp.open(<span style="color: #CD5555">&quot;GET&quot;</span>, <span style="color: #CD5555">&quot;filename&quot;</span>, <span style="color: #8B008B; font-weight: bold">true</span>);
<span style="color: #228B22">// Sends the request to the server for GET</span>
xhttp.send();
<span style="color: #228B22">// You can use send(string) to send the request for POST</span>
</pre></div>
            GET vs POST:
            <br></br>
            GET requests data from a specified source. POST submits data to be processed by a
            specified source. Both can be used to retrieve data from the server, but GET is simpler 
            and faster.  GET may return cached data, whereas POST will not. POST requests should
            be used when:
            <br></br>
            &bull; You're sending large amounts of data to a server (since it has no size limitation)
            <br></br>
            &bull; A cached file isn't an option (updating a file or database on the server)
            <br></br>
            &bull; Sending user input (it's more secure than GET) 
            </p>
        </div>
        <div>
            <h1>JSON HTTP Request</h1>
            <p>One thing you can do is read JSON data using the XMLHttpRequest.</p>
            <button type="button" id="btn" onclick="function()">Read some JSON data</button>
            <div id="id01"></div>
            <script>
                    var myArray = [
                    {
                    "display": "JavaScript Tutorial",
                    "url": "https://www.w3schools.com/js/default.asp"
                    },
                    {
                    "display": "HTML Tutorial",
                    "url": "https://www.w3schools.com/html/default.asp"
                    },
                    {
                    "display": "CSS Tutorial",
                    "url": "https://www.w3schools.com/css/default.asp"
                    }
                    ]

                    var xmlhttp = new XMLHttpRequest();
                    var url = "myTutorials.txt";
                    
                    xmlhttp.onreadystatechange = function() {
                      if (this.readyState == 4 && this.status == 200) {
                        var myArr = JSON.parse(this.responseText);
                        myFunction(myArr);
                      }
                    };
                    xmlhttp.open("GET", url, true);
                    xmlhttp.send();
                    
                    function myFunction(arr) {
                      var out = "";
                      var i;
                      for(i = 0; i < arr.length; i++) {
                        out += '<a href="' + arr[i].url + '">' + 
                        arr[i].display + '</a><br>';
                      }
                      document.getElementById("id01").innerHTML = out;
                    }
                    </script>
        </div>
    </main>
</body>
</html>